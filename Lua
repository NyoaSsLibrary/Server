--[[Melee Aura SLIVKINEEPY]]--

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local pgui = player:WaitForChild("PlayerGui")

local auraEnabled = false
local selectedWeapon = "Bat"
local maxDistance = 3

local weapons = {
    "Bat","Slap","Iron Slap","Gold Slap","Diamond Slap","Emerald Slap","Ruby Slap",
    "Dark Matter Slap","Flame Slap","Nuclear Slap","Galaxy Slap","Glitch Slap",
    "Splatter Slap","Gummy Slap","Blackhole Slap","Ban Hammer"
}

getgenv().MeleeAuraEnabled = false
getgenv().UnequipWhenUsed = false

getgenv().antiKick = true
local oldnc; oldnc = hookmetamethod(game, "__namecall", newcclosure(function(self, ...)
    local method = getnamecallmethod()
    if antiKick and method == "FireServer" and (tostring(self):find("ObserveTag") or tostring(self):find("Kick")) then
        return
    end
    return oldnc(self, ...)
end))

local sg = Instance.new("ScreenGui")
sg.Name = "NyoaHubSab"
sg.ResetOnSpawn = false
sg.Parent = pgui

local openBtn = Instance.new("TextButton")
openBtn.Size = UDim2.new(0,140,0,36)
openBtn.Position = UDim2.new(0,12,0.5,-18)
openBtn.BackgroundColor3 = Color3.fromRGB(10,10,22)
openBtn.Text = "open NyoaHub"
openBtn.TextColor3 = Color3.fromRGB(85,195,255)
openBtn.Font = Enum.Font.GothamBold
openBtn.TextSize = 18
openBtn.BackgroundTransparency = 0.25
openBtn.Parent = sg
Instance.new("UICorner", openBtn).CornerRadius = UDim.new(0,14)
Instance.new("UIStroke", openBtn).Color = Color3.fromRGB(70,70,95)

local main = Instance.new("Frame")
main.Size = UDim2.new(0,230,0,260)
main.Position = UDim2.new(0.5,-115,0.5,-130)
main.BackgroundColor3 = Color3.fromRGB(15,15,25)
main.Visible = false
main.Parent = sg
Instance.new("UICorner", main).CornerRadius = UDim.new(0,16)
local ms = Instance.new("UIStroke", main)
ms.Color = Color3.fromRGB(80,80,100)
ms.Thickness = 2.5

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1,0,0,42)
title.BackgroundColor3 = Color3.fromRGB(10,10,20)
title.Text = "NyoaSS melee"
title.TextColor3 = Color3.fromRGB(255,100,100)
title.Font = Enum.Font.GothamBold
title.TextSize = 20
title.Parent = main
Instance.new("UICorner", title).CornerRadius = UDim.new(0,16)

local discordLabel = Instance.new("TextLabel")
discordLabel.Size = UDim2.new(1,0,0,22)
discordLabel.Position = UDim2.new(0,0,0,40)
discordLabel.BackgroundTransparency = 1
discordLabel.Text = "discord.gg/WBYkWfPQC2"
discordLabel.TextColor3 = Color3.fromRGB(130,170,255)
discordLabel.Font = Enum.Font.Gotham
discordLabel.TextSize = 15
discordLabel.Parent = main

local close = Instance.new("TextButton")
close.Size = UDim2.new(0,36,0,36)
close.Position = UDim2.new(1,-42,0,3)
close.BackgroundTransparency = 1
close.Text = "X"
close.TextColor3 = Color3.fromRGB(255,90,90)
close.TextSize = 32
close.Font = Enum.Font.GothamBold
close.Parent = title

local toggle = Instance.new("TextButton")
toggle.Size = UDim2.new(0.86,0,0,46)
toggle.Position = UDim2.new(0.07,0,0,72)
toggle.BackgroundColor3 = Color3.fromRGB(190,40,50)
toggle.Text = "OFF"
toggle.TextColor3 = Color3.new(1,1,1)
toggle.Font = Enum.Font.GothamBold
toggle.TextSize = 26
toggle.Parent = main
Instance.new("UICorner", toggle).CornerRadius = UDim.new(0,12)

local dropLabel = Instance.new("TextLabel")
dropLabel.Size = UDim2.new(0.86,0,0,22)
dropLabel.Position = UDim2.new(0.07,0,0,130)
dropLabel.BackgroundTransparency = 1
dropLabel.Text = "(dropdown)"
dropLabel.TextColor3 = Color3.fromRGB(180,180,200)
dropLabel.Font = Enum.Font.Gotham
dropLabel.TextSize = 16
dropLabel.Parent = main

local dropBtn = Instance.new("TextButton")
dropBtn.Size = UDim2.new(0.86,0,0,40)
dropBtn.Position = UDim2.new(0.07,0,0,155)
dropBtn.BackgroundColor3 = Color3.fromRGB(35,35,50)
dropBtn.Text = "Bat"
dropBtn.TextColor3 = Color3.new(1,1,1)
dropBtn.Font = Enum.Font.GothamSemibold
dropBtn.TextSize = 20
dropBtn.Parent = main
Instance.new("UICorner", dropBtn).CornerRadius = UDim.new(0,10)

local dropList = Instance.new("ScrollingFrame")
dropList.Size = UDim2.new(0.86,0,0,85)
dropList.Position = UDim2.new(0.07,0,0,200)
dropList.BackgroundColor3 = Color3.fromRGB(30,30,45)
dropList.ScrollBarThickness = 4
dropList.Visible = false
dropList.CanvasSize = UDim2.new(0,0,0,#weapons*36)
dropList.Parent = main
Instance.new("UICorner", dropList).CornerRadius = UDim.new(0,10)

local lay = Instance.new("UIListLayout", dropList)
lay.Padding = UDim.new(0,4)

for _,w in ipairs(weapons) do
    local b = Instance.new("TextButton")
    b.Size = UDim2.new(1,0,0,34)
    b.BackgroundColor3 = Color3.fromRGB(45,45,65)
    b.Text = w
    b.TextColor3 = Color3.new(1,1,1)
    b.Font = Enum.Font.Gotham
    b.TextSize = 18
    b.Parent = dropList
    Instance.new("UICorner", b).CornerRadius = UDim.new(0,8)
    b.MouseButton1Click:Connect(function()
        selectedWeapon = w
        dropBtn.Text = w
        dropList.Visible = false
    end)
end

local function makeDraggable(frame)
    local dragging = false
    local dragInput, mousePos, framePos

    frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            mousePos = input.Position
            framePos = frame.Position

            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    frame.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if dragging and (input == dragInput or input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
            local delta = input.Position - mousePos
            frame.Position = UDim2.new(
                framePos.X.Scale,
                framePos.X.Offset + delta.X,
                framePos.Y.Scale,
                framePos.Y.Offset + delta.Y
            )
        end
    end)
end

makeDraggable(openBtn)
makeDraggable(main)

openBtn.MouseButton1Click:Connect(function() openBtn.Visible = false main.Visible = true end)
close.MouseButton1Click:Connect(function() main.Visible = false openBtn.Visible = true end)
dropBtn.MouseButton1Click:Connect(function() dropList.Visible = not dropList.Visible end)

RunService.Heartbeat:Connect(function()
    if not getgenv().MeleeAuraEnabled then
        if sg then sg.Enabled = false end
        return
    else
        if sg then sg.Enabled = true end
        end

    local char = player.Character
    if not char or not char:FindFirstChild("HumanoidRootPart") or not char:FindFirstChild("Humanoid") then return end

    local root = char.HumanoidRootPart
    local hum = char.Humanoid
    if hum.Health <= 0 then return end

    local tool = char:FindFirstChild(selectedWeapon) or player.Backpack:FindFirstChild(selectedWeapon)
    if not tool then return end

    local closest = nil
    local closestDist = maxDistance
    for _, p in Players:GetPlayers() do
        if p ~= player and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
            local dist = (root.Position - p.Character.HumanoidRootPart.Position).Magnitude
            if dist < closestDist then
                closestDist = dist
                closest = p.Character.HumanoidRootPart
            end
        end
    end

    if closest then
        hum:EquipTool(tool)

        local start = tick()
        repeat
            local lookAt = Vector3.new(closest.Position.X, root.Position.Y, closest.Position.Z)
            local targetCF = CFrame.new(root.Position, lookAt)
            root.CFrame = CFrame.new(root.Position) * targetCF.Rotation

            tool:Activate()
            RunService.Heartbeat:Wait()
        until tick() - start >= 0.5 or not auraEnabled or not closest.Parent

    if getgenv().UnequipWhenUsed then
        hum:UnequipTools()
    end
end)

toggle.MouseButton1Click:Connect(function()
    auraEnabled = not auraEnabled
    toggle.Text = auraEnabled and "ON" or "OFF"
    toggle.BackgroundColor3 = auraEnabled and Color3.fromRGB(0,255,0) or Color3.fromRGB(255,0,0)
end)
